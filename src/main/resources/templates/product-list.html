<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>å•†å“ä¸€è¦§</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <h1>ğŸ“‹ å•†å“ä¸€è¦§</h1>

    <table border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>ç¨®é¡</th>
                <th>å“ç¨®å</th>
                <th>è‰²</th>
                <th>å…¥è·æ—¥</th>
                <th>å…¥è·æ•°</th>
                <th>ä»•å…¥å˜ä¾¡</th>
                <th>åœ¨åº«æ•°</th>
                <th>ã—ãã„å€¤</th>
                <th>ç ´æ£„æ•°</th>
                <th>å‚™è€ƒ</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="product : ${products}"
                th:classappend="${product.threshold != null and product.stockQuantity <= product.threshold} ? 'low-stock'"
                <td th:text="${product.id}"></td>
                <td th:text="${product.type}"></td>
                <td th:text="${product.name}"></td>
                <td th:text="${product.color}"></td>
                <td th:text="${product.arrivalDate}"></td>
                <td th:text="${product.arrivalQuantity}"></td>
                <td th:text="${product.purchasePrice}"></td>
                <td th:text="${product.stockQuantity}"></td>
                <td th:text="${product.threshold}"></td>
                <td th:text="${product.discardQuantity}"></td>
                <td th:text="${product.note}"></td>
            </tr>
        </tbody>
    </table>

    <!-- ğŸ”” ã—ãã„å€¤ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º -->
    <div id="stock-alert" style="display:none; color: red; font-weight: bold; margin-top: 20px;">
        âš ï¸ åœ¨åº«ãŒã—ãã„å€¤ã‚’ä¸‹å›ã£ã¦ã„ã‚‹å•†å“ãŒã‚ã‚Šã¾ã™ï¼
    </div>

    <!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
    <br>
    <a th:href="@{/products/form}">ï¼‹ æ–°ã—ã„å•†å“ã‚’ç™»éŒ²</a><br>
    <a th:href="@{/dashboard/inventory}">â† åœ¨åº«ãƒ•ãƒ­ãƒ¼ã¸æˆ»ã‚‹</a>

    <!-- JSï¼šã—ãã„å€¤ãƒã‚§ãƒƒã‚¯ç”¨ -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let showAlert = false;

            const rows = document.querySelectorAll("tbody tr");
            rows.forEach(row => {
                const stock = parseInt(row.cells[7]?.textContent.trim());
                const threshold = parseInt(row.cells[8]?.textContent.trim());

                if (!isNaN(stock) && !isNaN(threshold) && stock <= threshold) {
                    showAlert = true;
                }
            });

            if (showAlert) {
                document.getElementById("stock-alert").style.display = "block";
            }
        });
    </script>
</body>
</html>
